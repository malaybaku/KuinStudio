# KuinStudio

Creator: Baku

公開日: 2017/4/16


## 1. About

[**プログラミング言語Kuin**](http://kuina.ch/kuin/1)をサポートするVisual Studio拡張です。以下の機能をサポートしています。

* Kuinプロジェクトの作成
* Kuinプロジェクトのビルドおよび実行
* `.kn`ファイルのシンタックスハイライト

以下の機能はサポートしていませんが、作りたいような気はしています。

* インテリセンス
* デバッグ実行

動作確認はVisual Studio Community 2017で行っています。



## 2. Kuin環境について

KuinStudio自体はKuin環境、とくにKuinコンパイラ(`kuincl.exe`)を同梱していません。使用にあたっては[オリジナルの配布元](http://kuina.ch/kuin/1)などから取得したものが必要になります。ただし、2017/4/16時点でKuin環境はオリジナル配布元からダウンロードできません。

KuinStudioの作者はKuin環境を持っており、
[**くいなちゃんライセンス**](http://kuina.ch/others/license)に基づいて再配布する権利がありますが、
配布元で非公開にしている事を踏まえて、KuinStudio越しでの再配布も意図的に避けています。



## 3. 使い方

### 3.1. インストール

「拡張機能と更新プログラム」でオンラインのタブを開き、`KuinStudio`で検索してインストールします。

### 3.2. Kuinコンパイラのパス設定

「ツール」の「オプション」から`KuinStudio`タブを選択し、`CompilerPath`へ、PC上にすでにある`kuincl.exe`の絶対パスを設定します。

### 3.3. Kuin用プロジェクト作成

新規プロジェクト作成時に`Kuin > Kuin Project`を選択します。プロジェクト作成後、`main.kn`のみからなるプロジェクトが新規作成されます。

注意ですが、KuinStudioは現在「単一のKuinプロジェクトのみからなるソリューション」に限って動作確認しています。複数のKuinプロジェクトがあるような構成ではうまく動作しない可能性があります。

### 3.4. プロジェクトのプロパティ

Kuinプロジェクトのプロパティでは以下の設定ができます(動作チェックはあまり徹底していません)。
* `Startup File`: エントリポイント(`main`関数)を含む`.kn`ファイル名を、`.knproj`ファイルが存在するディレクトリからの相対パスで指定します。プロジェクト作成時には`main.kn`が指定されています。
* `Output File (.exe)`: 出力ファイル名を、`.knproj`ファイルが存在するディレクトリからの相対パスで指定します。指定しない場合は`Startup File`のディレクトリに`out.exe`が出力されます。
* `Icon File (.ico)`: アイコンファイル名を、`.knproj`ファイルが存在するディレクトリからの相対パスで指定します。指定しなければデフォルトアイコンが適用されます。
    - アイコン設定に関してはknown issueがあります(後述)。
* `Working Directory`: デバッグ実行/リリース実行時の作業ディレクトリを指定します。既定値は`.`であり、`.knproj`ファイルが存在するディレクトリが作業ディレクトリになります。特に理由がない限り変更しないでください。
* `Application Type`: `Wnd`または`Cui`を選択します。`Wnd`を選択するとGUIアプリケーションとしてビルドし、`Cui`を選択するとCUIアプリケーションとしてビルドされます。`Web`は現時点では選択できません。
* `Custom System Directory`: 存在するディレクトリを指定した場合、kuinclコンパイラの`-s`オプションに引数として渡します。既定値は空欄であり、基本的に変更しないでください。

プロジェクトのアイコンファイルプロパティにかんする既知の問題として、アイコンファイルを指定しても出力した実行ファイルに反映されない場合があります。この場合、実行ファイルの名前を変えたり、エクスプローラの表示状態を切り替えると反映される場合があります。

KuinStudioの作者も動作がよくわかっていませんが、icoファイルの構成を変更したり、ファイル名の切り替えを行って対応してください。あるいは、最終的なリリースビルドはコマンドプロンプトから実施するようにしてください。



### 3.5. コマンド

ビルド、Run関連のコマンドを追加しています。以下の点に注意してください。

* デバッグビルドとリリースビルドの出力先は区別していません。
* ビルド、Runのいずれを行った場合でも、つねにリビルド処理が走ります。
    + Kuinはビルドが速いので、わざわざ再ビルドの必要/不要を判定していません。
* ビルド結果の出力は、単に`kuincl.exe`の出力を「出力」ウィンドウに表示するだけです。ビルドの成否は出力ウィンドウの内容で確認してください。

利用可能なコマンドは以下の通りです。いずれも、Kuinプロジェクトを開いた状態で使用可能です。

* ビルド > `Debug Build (Alt+K, B)`: リリースフラグなしでビルドします。
* ビルド > `Release Build (Alt+K, Ctrl+B)`: リリースフラグありでビルドします。
* デバッグ > `Debug Build and Run (Alt+K, F5)`: Debug Buildを行い、成功した場合はプログラムを実行します。
* デバッグ > `Release Build and Run (Alt+K, Ctrl+F5)`: Release Buildを行い、成功した場合はプログラムを実行します。



## 4. License

* KuinStudioはプロジェクト機能サポートのために[**Python tools for Visual Studio(PTVS)**](https://github.com/Microsoft/PTVS)のソースコードを用いており、PTVSはApache 2.0 Licenseに従います。
* KuinStudio本体として実装した部分はMITライセンスです。
* プログラミング言語「Kuin」はくいなちゃんの著作物であり、[**くいなちゃんライセンス**](http://kuina.ch/others/license)に従います。



## 5. Contact

(Kuin自体とは関係のなさそうな)KuinStudioへの不具合報告や要望につきましては下記へお願いします。

* Twitter: [**@baku_dreameater**](https://twitter.com/baku_dreameater)
* Blog: [**Bakulog**](http://www.baku-dreameater.net/)

